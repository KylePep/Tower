import{_ as k,u as C,m as x,w as I,d as l,P as v,n as g,t as b,r as S,o as n,c as a,a as t,i as _,j as d,e as E,F as y,f as T,q as D,s as A,v as B,A as m,g as j,p as P,k as M}from"./index-e7714abf.js";import{a as p}from"./AttendeesService-20bd03e7.js";const N={setup(){const r=C(),c=x({});async function h(o){try{await b.getTowerEventById(o)}catch(s){v.error(s.message)}}async function e(o){try{await g.getCommentsByEventId(o)}catch(s){v.error(s.message)}}async function u(o){try{await p.getTicketsByEventId(o)}catch(s){v.error(s.message)}}return I(()=>{h(r.params.eventId),e(r.params.eventId),u(r.params.eventId)}),{editable:c,AppState:l(()=>m),account:l(()=>m.account),activeTowerEvent:l(()=>m.activeEvent),comments:l(()=>m.comments),attendees:l(()=>m.attendees),alreadyAttending:l(()=>m.attendees.find(s=>s.accountId==m.account.id)),months:l(()=>["January","February","March","April","May","June","July","August","September","October","November","December"]),async createTicket(){try{const o={};o.eventId=r.params.eventId,await p.createTicket(o)}catch(o){v.error(o.message)}},async createComment(){try{const o=c.value;o.eventId=r.params.eventId,await g.createComment(o),c.value={}}catch(o){v.error(o.message)}},async cancelEvent(o){try{if(!await v.confirm("Do you want to cancel this event?"))return;await b.cancelEvent(o)}catch(s){v.error(s.message)}}}}},w=r=>(P("data-v-2b623997"),r=r(),M(),r),V={key:0,class:"row bg-color-1 rounded"},L={class:"col-12 view-reserved d-flex flex-column justify-content-center fs-3 text-color-5 p-3"},F={class:"row"},J={class:"col-12 col-md-3 position-relative pb-3"},U=["src","alt"],q={key:0},O=w(()=>t("div",{class:"d-flex text-black-50 fs-1 fw-bold position-absolute cancelDisplay align-items-center justify-content-center px-5"},[t("div",null," Canceled ")],-1)),R=[O],z={class:"col-12 col-md-9"},G={class:"row"},H=w(()=>t("div",null,null,-1)),K={key:0,class:"d-flex justify-content-end"},Q={class:"row"},W={class:"col-6"},X={class:"col-6 text-end"},Y={class:"row"},Z={class:"py-3 text-light"},$={key:0,class:"bg-warning text-dark text-center"},ee={key:1},te={key:0},oe={key:0,class:"d-flex flex-row justify-content-between"},ne={key:0},ae={key:1},ce=w(()=>t("i",{class:"mdi mdi-account-plus"},null,-1)),se={key:2},ie=w(()=>t("div",{class:"border border-light border-3 rounded text-light p-2"}," Attending ",-1)),re=[ie],de={key:1},le={class:"row bg-color-2 p-3"},ve={class:"d-flex flex-row"},me=["src","alt","title"],_e={class:"row pe-0 mt-3"},we={class:"col-12 col-md-9 m-auto gradient-background"},ye={key:0},he=w(()=>t("label",{for:"body",class:"fs-3 fw-bold text-color-5"},"Comment",-1)),ue=w(()=>t("div",{class:"d-flex justify-content-end py-3"},[t("button",{class:"btn btn-primary"},"Submit")],-1));function fe(r,c,h,e,u,o){var f;const s=S("CommentCard");return n(),a(y,null,[e.activeTowerEvent?(n(),a("section",V,[t("div",L,[t("section",F,[t("div",J,[t("img",{class:"img-fluid detailsImg",src:e.activeTowerEvent.coverImg,alt:e.activeTowerEvent.name},null,8,U),e.activeTowerEvent.isCanceled!=!1?(n(),a("div",q,R)):_("",!0)]),t("div",z,[t("section",G,[H,e.account.id==e.activeTowerEvent.creatorId&&e.activeTowerEvent.isCanceled==!1?(n(),a("div",K,[t("button",{onClick:c[0]||(c[0]=i=>e.cancelEvent(e.activeTowerEvent.id)),class:"btn btn-danger"}," Cancel Event")])):_("",!0)]),t("section",Q,[t("div",W,[t("h1",null,d(e.activeTowerEvent.name),1),t("h2",null,d(e.activeTowerEvent.location),1)]),t("div",X,[t("h2",null,[E(d(new Date(e.activeTowerEvent.startDate).getUTCDate())+" ",1),t("span",null,d(e.months[new Date(e.activeTowerEvent.startDate).getMonth()]),1)]),t("h3",null," Starting at "+d(new Date(e.activeTowerEvent.startDate).toLocaleTimeString("en-US",{hour:"2-digit",minute:"2-digit"})),1)])]),t("section",Y,[t("h5",Z,d(e.activeTowerEvent.description),1),e.activeTowerEvent.capacity-e.activeTowerEvent.ticketCount<=0?(n(),a("div",$," Sold out ")):(n(),a("div",ee,[e.account.id?(n(),a("h6",te,[e.activeTowerEvent.isCanceled==!1?(n(),a("div",oe,[e.activeTowerEvent.isCanceled==!1?(n(),a("div",ne,d(e.activeTowerEvent.capacity-e.activeTowerEvent.ticketCount)+" Spots Left ",1)):_("",!0),e.alreadyAttending?(n(),a("div",se,re)):(n(),a("div",ae,[t("button",{onClick:c[1]||(c[1]=i=>e.createTicket()),class:"btn btn-warning"},[ce,E(" Attend")])]))])):_("",!0)])):(n(),a("h6",de,d(e.activeTowerEvent.capacity-e.activeTowerEvent.ticketCount)+" Spots Left ",1))]))])])])])])):_("",!0),t("section",le,[t("div",ve,[(n(!0),a(y,null,T(e.attendees,i=>(n(),a("div",{key:i.id},[t("img",{class:"avatar-img attendeeImg",src:i.profile.picture,alt:i.profile.name,title:i.profile.name},null,8,me)]))),128))])]),t("section",_e,[t("div",we,[e.account.id&&((f=e.activeTowerEvent)==null?void 0:f.isCanceled)==!1?(n(),a("div",ye,[t("form",{onSubmit:c[3]||(c[3]=D(i=>e.createComment(),["prevent"])),class:"col-12 pt-3 px-md-3"},[he,A(t("textarea",{"onUpdate:modelValue":c[2]||(c[2]=i=>e.editable.body=i),class:"form-control",name:"body",id:"body",cols:"30",rows:"3",placeholder:"Comment",required:""},null,512),[[B,e.editable.body]]),ue],32)])):_("",!0),(n(!0),a(y,null,T(e.comments,i=>(n(),a("div",{key:i.id,class:"col-12 m-auto text-light pb-3 p-md-5"},[j(s,{commentProp:i},null,8,["commentProp"])]))),128))])])],64)}const Ee=k(N,[["render",fe],["__scopeId","data-v-2b623997"]]);export{Ee as default};
